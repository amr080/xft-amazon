{"ast":null,"code":"import _asyncToGenerator from\"/workspaces/xft-amazon/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspaces/xft-amazon/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/workspaces/xft-amazon/node_modules/@babel/runtime/regenerator/index.js\";import{Select,Button,Modal,Input}from'antd';import{ShoppingCartOutlined}from\"@ant-design/icons\";import{useState}from'react';import{useMoralis}from'react-moralis';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Option=Select.Option;function Purchase(_ref){var book=_ref.book;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isModalVisible=_useState2[0],setIsModalVisible=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),delivery=_useState4[0],setDelivery=_useState4[1];var _useMoralis=useMoralis(),Moralis=_useMoralis.Moralis,account=_useMoralis.account,chainId=_useMoralis.chainId;var handleOk=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var options,price,priceMatic,options1,result,Transaction,transaction;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// Get The Price of MATIC\noptions={address:\"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0\",chain:\"eth\"};_context.next=3;return Moralis.Web3API.token.getTokenPrice(options);case 3:price=_context.sent;priceMatic=book.price/price.usdPrice;// Send Matic to book store owenr address\noptions1={type:\"native\",amount:Moralis.Units.ETH(priceMatic),receiver:\"0x398a8168047a56e14F46e7D4C76ed928c2ce8D59\"};_context.next=8;return Moralis.transfer(options1);case 8:result=_context.sent;//Save Transaction Details to DB\nTransaction=Moralis.Object.extend(\"Transaction\");transaction=new Transaction();transaction.set(\"Customer\",account);transaction.set(\"Delivery\",delivery);transaction.set(\"Product\",book.name);transaction.save();setIsModalVisible(false);case 16:case\"end\":return _context.stop();}}},_callee);}));return function handleOk(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"price\",children:[\" $\",book.price]}),/*#__PURE__*/_jsx(\"p\",{children:\"No Import Fees & Free Shipping Included\"}),/*#__PURE__*/_jsx(\"h1\",{style:{color:\"green\"},children:\" In Stock \"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Quantity\"}),/*#__PURE__*/_jsxs(Select,{defaultValue:1,style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(Option,{value:1,children:\"1\"}),/*#__PURE__*/_jsx(Option,{value:2,children:\"2\"}),/*#__PURE__*/_jsx(Option,{value:3,children:\"3\"}),/*#__PURE__*/_jsx(Option,{value:4,children:\"4\"}),/*#__PURE__*/_jsx(Option,{value:5,children:\"5\"})]}),chainId===\"0x13881\"&&/*#__PURE__*/_jsxs(Button,{className:\"login\",style:{width:\"100%\",marginTop:\"50px\"},onClick:function onClick(){return setIsModalVisible(true);},children:[/*#__PURE__*/_jsx(ShoppingCartOutlined,{}),\" Buy Now\"]}),/*#__PURE__*/_jsx(Modal,{title:\"Purchase Product\",visible:isModalVisible,onOk:handleOk,onCancel:function onCancel(){return setIsModalVisible(false);},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\"},children:[/*#__PURE__*/_jsx(\"img\",{src:book.image,alt:\"product\",style:{width:\"200px\"}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:book.name}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"$\",book.price]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Delivery Address\"}),/*#__PURE__*/_jsx(Input,{onChange:function onChange(value){return setDelivery(value.target.value);}})]})]})})]});}export default Purchase;","map":{"version":3,"sources":["/workspaces/xft-amazon/src/components/Purchase.js"],"names":["Select","Button","Modal","Input","ShoppingCartOutlined","useState","useMoralis","Option","Purchase","book","isModalVisible","setIsModalVisible","delivery","setDelivery","Moralis","account","chainId","handleOk","options","address","chain","Web3API","token","getTokenPrice","price","priceMatic","usdPrice","options1","type","amount","Units","ETH","receiver","transfer","result","Transaction","Object","extend","transaction","set","name","save","color","width","marginTop","display","image","value","target"],"mappings":"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","sourcesContent":["import {Select, Button, Modal, Input} from 'antd'\nimport {ShoppingCartOutlined} from \"@ant-design/icons\";\nimport { useState } from 'react';\nimport { useMoralis } from 'react-moralis';\n\nconst {Option} = Select;\nfunction Purchase({book}) {\n  const [isModalVisible, setIsModalVisible] = useState(false);\n  const [delivery, setDelivery] = useState(\"\");\n  const {Moralis, account, chainId} = useMoralis();\n\n  const handleOk = async () => {\n\n    // Get The Price of MATIC\n\n    const options = {\n      address: \"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0\",\n      chain: \"eth\"\n    };\n    const price = await Moralis.Web3API.token.getTokenPrice(options);\n    const priceMatic = book.price / price.usdPrice;\n    \n    // Send Matic to book store owenr address\n\n    const options1 = {\n      type: \"native\", \n      amount: Moralis.Units.ETH(priceMatic), \n      receiver: \"0x398a8168047a56e14F46e7D4C76ed928c2ce8D59\"\n    }\n    let result = await Moralis.transfer(options1)\n\n\n    //Save Transaction Details to DB\n    const Transaction = Moralis.Object.extend(\"Transaction\");\n    const transaction = new Transaction();\n\n    transaction.set(\"Customer\", account);\n    transaction.set(\"Delivery\", delivery);\n    transaction.set(\"Product\", book.name);\n\n    transaction.save()\n\n    setIsModalVisible(false);\n  }\n\n  return (\n    <>\n      <span className=\"price\"> ${book.price}</span>\n      <p>No Import Fees & Free Shipping Included</p>\n      <h1 style={{ color: \"green\" }}> In Stock </h1>\n      <h3>Quantity</h3>\n      <Select defaultValue={1} style={{ width: \"100%\" }}>\n        <Option value={1}>1</Option>\n        <Option value={2}>2</Option>\n        <Option value={3}>3</Option>\n        <Option value={4}>4</Option>\n        <Option value={5}>5</Option>\n      </Select>\n      {chainId === \"0x13881\" &&\n      <Button\n        className=\"login\"\n        style={{ width: \"100%\", marginTop: \"50px\" }}\n        onClick={()=>setIsModalVisible(true)}\n    >\n      <ShoppingCartOutlined /> Buy Now\n    </Button>\n      }\n      \n      <Modal\n        title=\"Purchase Product\"\n        visible={isModalVisible}\n        onOk={handleOk}\n        onCancel={()=>setIsModalVisible(false)}\n      >\n        <div style={{ display: \"flex\" }}>\n          <img src={book.image} alt=\"product\" style={{ width: \"200px\" }}></img>\n          <div>\n            <h3>{book.name}</h3>\n            <h2>${book.price}</h2>\n            <h4>Delivery Address</h4>\n            <Input onChange={(value) => setDelivery(value.target.value)}></Input>\n          </div>\n        </div>\n      </Modal>\n    </>\n  )\n}\n\nexport default Purchase"]},"metadata":{},"sourceType":"module"}